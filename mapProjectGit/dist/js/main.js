function initMap(){var e={lat:30.274185,lng:-97.74054};map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:e}),ko.applyBindings(new searchAndPlaces)}var map=null,currentmarkerViewed=null,myPlaces=[{label:"C",locName:"State Capitol",address:"1100 congress avenue",lat:30.274185,lng:-97.74054,wiki:"Texas_State_Capitol"},{label:"P",locName:"The Paramount",address:"713 congress avenue",lat:30.269377,lng:-97.741872,wiki:"Paramount_Theatre_(Austin,_Texas)"},{label:"A",locName:"ACL Theater",address:"224 lavaca st",lat:30.265364,lng:-97.747274,wiki:"Block_21"},{label:"R",locName:"Rainey Street",address:"77 Rainey St",lat:30.258619,lng:-97.738947,wiki:"Rainey_Street_Historic_District_(Austin,_Texas)"},{label:"F",locName:"Franklins BBQ",address:"900 E 11th St",lat:30.270119,lng:-97.731273,wiki:"Franklin_Barbecue"},{label:"UT",locName:"UT Tower",address:"110 inner campus drive",lat:30.287065,lng:-97.738459,wiki:"Main_Building_(University_of_Texas_at_Austin)"}],Places=function(e,i,a,t,s,n){var o=this;this.latitude=t,this.longitude=s,this.address=a,this.locName=i,this.label=e,this.wiki=n,this.marker=new google.maps.Marker({position:{lat:this.latitude,lng:this.longitude},map:map,title:this.locName,label:this.label}),this.hidetheoptionsinsearch=function(){this.marker.setVisible(!1)},this.showtheoptionsinsearch=function(){this.marker.setVisible(!0)};var l=this.locName+": click on the button to view the Wikipedia Article";this.infowindow=new google.maps.InfoWindow({content:l}),this.pickaWiki=function(){return o.wiki},this.closeinfoWindow=function(){o.infowindow.close(),o.marker.setIcon()},this.marker.addListener("click",function(){null!==currentmarkerViewed&&currentmarkerViewed.closeinfoWindow(),o.infowindow.open(map,o.marker),o.marker.setIcon("http://maps.google.com/mapfiles/ms/icons/blue.png"),currentmarkerViewed=o}),this.infowindow.addListener("closeclick",o.closeinfoWindow)},searchAndPlaces=function(){var e=this;e.places=ko.observableArray([]),e.search=ko.observable(""),e.wiki=ko.observable("Click a Location button to view a Wikipedia Article"),e.bgImg=ko.observable("img/austin-skyline.jpg");for(var i=0;i<myPlaces.length;i++)e.places.push(new Places(myPlaces[i].label,myPlaces[i].locName,myPlaces[i].address,myPlaces[i].lat,myPlaces[i].lng,myPlaces[i].wiki));e.wikipedia=function(){var i="https://en.wikipedia.org/w/api.php?action=parse&format=json&prop=text&section=0&page=%wikiTitle%&callback=?",a=i.replace("%wikiTitle%",this.pickaWiki());$.ajax({type:"GET",url:a,contentType:"application/json; charset=utf-8",async:!1,dataType:"json",success:function(i,a,t){var s=i.parse.text["*"];e.wiki(s)},error:function(e,i,a){alert(e.status+" Error: the wikipedia article failed to load, please try again later")}})},this.backgroundAndInfo=function(){null!==currentmarkerViewed&&currentmarkerViewed.closeinfoWindow(),this.infowindow.open(map,this.marker),this.marker.setIcon("http://maps.google.com/mapfiles/ms/icons/blue.png");var i=this.address,a="austin, tx",t=i+" "+a,s="http://maps.googleapis.com/maps/api/streetview?size=600x400&location="+t;e.bgImg(s),currentmarkerViewed=this},e.listofPlaces=ko.computed(function(){if(""!==e.search){var a=new RegExp(e.search(),"i"),t=[];for(i=0;i<e.places().length;i++){var s=e.places()[i];a.test(s.locName)?(s.showtheoptionsinsearch(),t.push(s)):(s.hidetheoptionsinsearch(),s.closeinfoWindow())}return t}for(i=0;i<e.places().length;i++)e.places()[i].showtheoptionsinsearch();return e.places()})};