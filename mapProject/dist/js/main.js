function initMap(){var e={lat:30.274185,lng:-97.74054};map=new google.maps.Map(document.getElementById("map"),{zoom:13,center:e}),ko.applyBindings(new searchAndPlaces)}function errorFunction(){alert("there was an error in loading")}var map=null,currentMarkerViewed=null,myPlaces=[{label:"C",locName:"State Capitol",lat:30.274185,lng:-97.74054,wiki:"Texas_State_Capitol"},{label:"P",locName:"The Paramount",lat:30.269377,lng:-97.741872,wiki:"Paramount_Theatre_(Austin,_Texas)"},{label:"A",locName:"ACL Theater",lat:30.265364,lng:-97.747274,wiki:"Block_21"},{label:"R",locName:"Rainey Street",lat:30.258619,lng:-97.738947,wiki:"Rainey_Street_Historic_District_(Austin,_Texas)"},{label:"F",locName:"Franklins BBQ",lat:30.270119,lng:-97.731273,wiki:"Franklin_Barbecue"},{label:"UT",locName:"UT Tower",lat:30.287065,lng:-97.738459,wiki:"Main_Building_(University_of_Texas_at_Austin)"}],Places=function(e,i,a,t,n){var l=this;this.latitude=a,this.longitude=t,this.locName=i,this.label=e,this.wiki=n,this.marker=new google.maps.Marker({position:{lat:this.latitude,lng:this.longitude},map:map,title:this.locName,label:this.label,animation:google.maps.Animation.DROP}),this.hideOptionsInSearch=function(){this.marker.setVisible(!1)},this.showOptionsInSearch=function(){this.marker.setVisible(!0)},this.infowindow=new google.maps.InfoWindow({content:this.locName}),this.closeInfoWindow=function(){l.infowindow.close(),l.marker.setIcon()},this.wikipedia=function(e,i){var a="https://en.wikipedia.org/w/api.php?action=parse&format=json&prop=text&section=0&page=%wikiTitle%&callback=?".replace("%wikiTitle%",e);$.ajax({type:"GET",url:a,contentType:"application/json; charset=utf-8",async:!0,dataType:"json",success:function(e,a,t){var n=e.parse.text["*"].replace(new RegExp('href="/wiki',"g"),'href="https://en.wikipedia.org/wiki').replace(/<img[^>]*>/g,"");i(n)},error:function(e,i,a){alert(e.status+" Error: the wikipedia article failed to load, please try again later")}})},this.infowindow.addListener("closeclick",l.closeInfoWindow)},searchAndPlaces=function(){var e=this;e.places=ko.observableArray([]),e.search=ko.observable(""),e.wiki1=ko.observable("Click a Location button to view a Wikipedia Article"),e.bgImg=ko.observable("img/austin-skyline.jpg");for(a=0;a<myPlaces.length;a++)e.places.push(new Places(myPlaces[a].label,myPlaces[a].locName,myPlaces[a].lat,myPlaces[a].lng,myPlaces[a].wiki));e.wikipedia1=function(){this.wikipedia(this.wiki,e.wiki1),null!==currentMarkerViewed&&currentMarkerViewed.closeInfoWindow(),this.infowindow.open(map,this.marker),this.marker.setIcon("http://maps.google.com/mapfiles/ms/icons/blue.png"),currentMarkerViewed=this},e.listofPlaces=ko.computed(function(){if(""!==e.search){var i=new RegExp(e.search(),"i"),t=[];for(a=0;a<e.places().length;a++){var n=e.places()[a];i.test(n.locName)?(n.showOptionsInSearch(),t.push(n)):(n.hideOptionsInSearch(),n.closeInfoWindow())}return t}for(a=0;a<e.places().length;a++)e.places()[a].showOptionsInSearch();return e.places()});for(var i=[],a=0;a<e.places().length;a++)i.push(function(){var i=e.places()[a],t=e.places()[a].marker;t.addListener("click",function(){i.wikipedia(i.wiki,e.wiki1),null!==currentMarkerViewed&&currentMarkerViewed.closeInfoWindow(),i.infowindow.open(map,t),t.setIcon("http://maps.google.com/mapfiles/ms/icons/blue.png"),currentMarkerViewed=i})}())};